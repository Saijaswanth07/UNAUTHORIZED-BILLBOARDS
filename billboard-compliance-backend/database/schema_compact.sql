CREATE DATABASE IF NOT EXISTS billboard_compliance CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci;USE billboard_compliance;CREATE TABLE IF NOT EXISTS users (
id INT AUTO_INCREMENT PRIMARY KEY,username VARCHAR(50) UNIQUE NOT NULL,email VARCHAR(100) UNIQUE NOT NULL,hashed_password VARCHAR(255) NOT NULL,full_name VARCHAR(100),is_active BOOLEAN DEFAULT TRUE,is_superuser BOOLEAN DEFAULT FALSE,created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP) ENGINE=InnoDB;CREATE TABLE IF NOT EXISTS billboards (
id INT AUTO_INCREMENT PRIMARY KEY,title VARCHAR(100) NOT NULL,description TEXT,location VARCHAR(255) NOT NULL,latitude DECIMAL(10, 8),longitude DECIMAL(11, 8),size VARCHAR(50) NOT NULL,is_active BOOLEAN DEFAULT TRUE,created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP) ENGINE=InnoDB;CREATE TABLE IF NOT EXISTS compliance_checks (
id INT AUTO_INCREMENT PRIMARY KEY,billboard_id INT NOT NULL,checked_by INT NOT NULL,check_date DATE NOT NULL,status ENUM('compliant','non_compliant','pending') NOT NULL,notes TEXT,created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,FOREIGN KEY(billboard_id)REFERENCES billboards(id)ON DELETE CASCADE,FOREIGN KEY(checked_by)REFERENCES users(id)ON DELETE CASCADE)ENGINE=InnoDB;CREATE TABLE IF NOT EXISTS violations (
id INT AUTO_INCREMENT PRIMARY KEY,compliance_check_id INT NOT NULL,violation_type VARCHAR(100) NOT NULL,description TEXT,is_resolved BOOLEAN DEFAULT FALSE,resolved_at TIMESTAMP NULL,resolved_by INT NULL,created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,FOREIGN KEY(compliance_check_id)REFERENCES compliance_checks(id)ON DELETE CASCADE,FOREIGN KEY(resolved_by)REFERENCES users(id)ON DELETE SET NULL)ENGINE=InnoDB;CREATE TABLE IF NOT EXISTS media (
id INT AUTO_INCREMENT PRIMARY KEY,file_path VARCHAR(255) NOT NULL,file_type VARCHAR(50) NOT NULL,file_size INT NOT NULL,uploader_id INT NOT NULL,related_table ENUM('billboards','compliance_checks','violations') NOT NULL,related_id INT NOT NULL,created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,FOREIGN KEY(uploader_id)REFERENCES users(id)ON DELETE CASCADE,INDEX(related_table,related_id))ENGINE=InnoDB;CREATE INDEX idx_billboard_location ON billboards(location);CREATE INDEX idx_billboard_status ON billboards(is_active);CREATE INDEX idx_compliance_check_date ON compliance_checks(check_date);CREATE INDEX idx_compliance_status ON compliance_checks(status);CREATE INDEX idx_violation_resolved ON violations(is_resolved,resolved_at);
